<!DOCTYPE html>
<html>
<head>
    <title></title>
</head>
<body onLoad="init();" style="background: #ff9900;">

<canvas id="demoCanvas" width="1100" height="1100">
        	alternate crap for junk ass users
</canvas>
<script type="text/javascript" src="js/lib/preloadjs.js"></script>
<script type="text/javascript" src="js/lib/easeljs/utils/UID.js"></script>
<script type="text/javascript" src="js/lib/easeljs/geom/Matrix2D.js"></script>
<script type="text/javascript" src="js/lib/easeljs/events/EventDispatcher.js"></script>
<script type="text/javascript" src="js/lib/easeljs/display/DisplayObject.js"></script>
<script type="text/javascript" src="js/lib/easeljs/display/Container.js"></script>
<script type="text/javascript" src="js/lib/easeljs/display/Stage.js"></script>
<script type="text/javascript" src="js/lib/easeljs/events/MouseEvent.js"></script>
<script type="text/javascript" src="js/lib/easeljs/display/Bitmap.js"></script>
<script type="text/javascript" src="js/lib/easeljs/display/Graphics.js"></script>
<script type="text/javascript" src="js/lib/easeljs/display/Shadow.js"></script>
<script type="text/javascript" src="js/lib/easeljs/display/Shape.js"></script>
<script type="text/javascript" src="js/lib/easeljs/geom/Rectangle.js"></script>
<script type="text/javascript" src="js/lib/easeljs/utils/Ticker.js"></script>
<script type="text/javascript" src="js/lib/easeljs/filters/Filter.js"></script>
<script type="text/javascript" src="js/lib/easeljs/filters/BoxBlurFilter.js"></script>
<script type="text/javascript" src="js/lib/easeljs/filters/ColorMatrixFilter.js"></script>
<script type="text/javascript" src="js/lib/easeljs/filters/ColorMatrix.js"></script>
<script type="text/javascript" src="js/lib/easeljs/filters/AlphaMaskFilter.js"></script>
<script type="text/javascript" src="js/lib/easeljs/ui/Touch.js"></script>

<script>

    var canvas, stage;

    var scale;
	var angle;
    var puzzleImage;
    var startX = 0;
    var startY = 0;
    var totalRows = 6;
    var totalCols = 6;
  //  var wide = 130;
    var paddingX = 100;
    var paddingY = 100;

    var board = [];
    var assets = [];

    function init(){
        canvas = document.getElementById("demoCanvas");
        stage = new createjs.Stage(canvas);

        //touch events:
        createjs.Touch.enable(stage);

        //container:
        var container = new createjs.Container();
        stage.addChild(container);

        //Image to solve:
        puzzleImage = new Image();
        puzzleImage.src = "img/zelda.jpg";
        puzzleImage.onload  = puzzleLoaded;

        function puzzleLoaded()
        {
            var colCounter = 0;
			var posIdx = 0;

            //game board:
            for (rowCounter = 0; rowCounter < totalRows; rowCounter++)
			{
                for (colCounter = 0; colCounter < totalCols; colCounter++)
                {
                    //puzzle image:
                    var bitmap = new createjs.Bitmap(puzzleImage);


                    //chop up image:
                    bitmap.sourceRect = new createjs.Rectangle(colCounter * paddingX, rowCounter * paddingY,  paddingX, paddingY);
                    bitmap.x = startX + startX + (colCounter * paddingY);
                    bitmap.y = rowCounter * paddingY;
                    // bitmap.shadow = new createjs.Shadow("#000000", 2, 2, 5);

                    //draw pieces
                    var x8 = Math.round(paddingY / 10);
			     	var y8 = Math.round(paddingY / 10);
                    //puzzle:
                    var piece = new createjs.Shape();
                    piece.graphics.beginFill("#000000");
                    piece.graphics.moveTo(0, 0);
                    piece.graphics.lineTo(8*x8,0);
                    piece.graphics.lineTo(8*x8,3*y8)
                    piece.graphics.quadraticCurveTo(10*x8,2*y8,10*x8,4*y8);
				    piece.graphics.quadraticCurveTo(10*x8,6*y8,8*x8,5*y8);
                    piece.graphics.lineTo(8*x8,8*y8);
                    piece.graphics.lineTo(5*x8,8*y8);
                    piece.graphics.quadraticCurveTo(6*x8,10*y8,4*x8,10*y8);
					piece.graphics.quadraticCurveTo(2*x8,10*y8,3*x8,8*y8);
                    piece.graphics.lineTo(0,8*y8);
                    piece.graphics.lineTo(0,5*y8);
                    piece.graphics.quadraticCurveTo(2*x8,6*y8,2*x8,4*y8);
					piece.graphics.quadraticCurveTo(2*x8,2*y8,0,3*y8);
                    piece.graphics.lineTo(0,0);
                    piece.graphics.beginFill();

                    piece.cache(0, 0, paddingX, paddingY);

                     //masking
                    var amf = new createjs.AlphaMaskFilter(piece.cacheCanvas);
                    bitmap.filters = [amf];
                    bitmap.cache(0, 0, paddingX, paddingY);

                    // wrapper function to provide scope for the event handlers for dragging pieces:
                    (function(target) {
                        bitmap.onPress = function(evt) {
                            // bump the target in front of it's siblings:
                            container.addChild(target);
                            var offset = {x : target.x - evt.stageX, y : target.y - evt.stageY};

                            // add a handler to the event object's onMouseMove callback
                            // this will be active until the user releases the mouse button:
                            evt.onMouseMove = function(ev) {
                                target.x = ev.stageX + offset.x;
                                target.y = ev.stageY + offset.y;
                                // indicate that the stage should be updated on the next tick:
                                update = true;
                            }
                        }
                        bitmap.onMouseOver = function() {
                            target.scaleX = target.scaleY = target.scale * 1.2;
                            update = true;
                        }
                        bitmap.onMouseOut = function() {
                            target.scaleX = target.scaleY = target.scale;
                            update = true;
                        }
                    })(bitmap);

                    container.addChild(bitmap);
                    posIdx++;
                }
			}
            createjs.Ticker.addEventListener("tick", tick);
        }

        function tick(event)
        {
            stage.update(event);
	    }
    }

</script>

</body>
</html>